Protractor
====================
Protractor is an end-to-end testing framework for AngularJS applications and works as a solution integrator - combining powerful tools and technologies such as NodeJS, Selenium, webDriver, Jasmine, Cucumber and Mocha.

Video Tutorial: http://jenkinsqa.odesk.com:8080/job/protractor_tutorial_videos/ 


### Setting up IDE to view JS
ECLIPSE:: This will prep eclipse to read javascript.

+ Go into eclipse and nstall new software
 + http://download.eclipse.org/releases/juno
+ Select Web, XML, Java EE, etc (and download all of the following addon)
 + Pick JavaScript Development Tools
 + Pick Eclipse Web Developer Tools
 + Pick Web Page Editor
 + IDE will now be able to recognize these files

PHPSTORM:: This will prep phpstorm to read nodejs and run debugger. (I suggest to use this IDE)

+ Install: http://www.jetbrains.com/phpstorm/
+ Download and enable nodejs plugin: 
 + Click on PHPSTORM -> preferences -> IDE Settings -> Plugins
 + Browse repo and search for nodejs. Install and restart.
 + Browse repo and search for jasmine. Install ddescriber for jasmine js.
 + Update IDE to recognize jasmine method: <a href="http://stackoverflow.com/questions/8108461/how-can-i-get-webstorm-to-recognize-jasmine-methods">LINK</a> ; make sure to also get angularjs as well.
 + Go here to setup IDE: https://www.youtube.com/watch?v=VLMyI7QKcwg . This will show you how to debug and run through IDE.
 + Update phpstorm nodejs config so you can easily run and debug specs:
   + ![Alt text](IDEwindows.png?raw=true "windows") 
   + ![Alt text](IDEmac.png?raw=true "mac") 

**Update IDE to use 2 space-tabs instead of full indent**

**Note**:  GhostDriver (selenium driver for phantomjs) has a [known issue](https://github.com/detro/ghostdriver/issues/170)
which causes cookies to be persisted between test runs. For now all tests will be executed using Chrome to avoid this issue.

Installation
-----
###MAC
+ Install NodeJS installer from https://nodejs.org/
+ Run the installer to install Nodejs in your mac
+ Install Protractor and WebDriver globally ```npm install -g protractor```
+ Update webdrivers ```webdriver-manager update```


###Windows
+ Install NodeJS and npm (NodeJS Package Manager). Go to http://nodejs.org/, download nodeJS Windows Installer msi. Set install location to C:\Program Files\nodejs\
+ Check NodeJS installation, type "node --version" in command prompt window.
+ Check npm installation, type "npm --version" in command prompt window.
+ Install Protractor and Selenium Web Driver globally. ```npm install protractor -g```. This will install both protractor and selenium-webdriver into Users\${user}\AppData\Roaming\npm\node_modules\
+ Update Web Driver version ```webdriver-manager update```


Add protractor-core (in-house common helper functions) to your project
---
+ The protractor-core is a prerequisite for your protractor test project. It contains the common utilities, configurations, timeout values for your tests.  
+ In your project folder, create a ```package.json``` like below. This will download protractor-core and save it in the node_module folder as dependency for your protractor project.
### Example of package.json:
```
{
  "name": "mobile2.0",
  "version": "2.1.1",
  "description": "Mobile Web automation using Protractor: http://stash.odesk.com/projects/QA/repos/mobile2.0/browse",
  "dependencies": {
    "protractor-core": "git+ssh://git@stash.odesk.com:7999/qa/protractor-core.git"
  }
}
```
+ Run `npm install`
+ For example: mobile2.0: ```http://stash.odesk.com/projects/QA/repos/mobile2.0/browse/package.json```.  Mobile2.0 repo has its own package.json that call protractor-core.  We want each stack to have its own separate repo that is independent of each other.  This give more mobility to every team.  If you think a functions will be shared across all team, then implement it into protractor-core and let the rest of the team know. 
+ Note: There isn't a true "core qa team" in protractor, you're require to write your own functions.  All the api provided by angularjs for protractor are all online and easily searchable with examples.




Start WebDriver
------
* This will start the driver and allow us to run protractor: ```webdriver-manager start```


Run Protractor Test
------
+ Sample command to run the config which can contain multiple specs:
 + ```node protractor client/node_modules/protractor-core/conf/localhost_conf.js --baseUrl https://workplace-internal.elance.com```
+ Sample command to run a single spec with existing conf:
 + ```node protractor client/node_modules/protractor-core/conf/localhost_conf.js --specs=client/e2e/specs/WP-302_spec.js --baseUrl https://workplace-internal.elance.com```
+ Sample command to run a single spect:
 + ```node protractor /node_modules/protractor-core/conf/eom_conf.js --browser=chrome --specs=/specs/EOM-1357_spec.js --baseUrl=https://stage.upwork.com --verbose --params.report=EOM-1357 ```



References
----------
+ [Powerpoint slide Demo](http://ramonvictor.github.io/protractor/slides/#/)
+ [doc.angularjs.org](https://docs.angularjs.org/guide/e2e-testing)
+ [Practical E2E](http://www.ng-newsletter.com/posts/practical-protractor.html)
+ [Video Demo](https://egghead.io/series/learn-protractor-testing-for-angularjs)
+ [Protractor Element](https://github.com/angular/protractor/blob/master/docs/api.md#protractorbyprototypeexactbinding)

Issues During Installation:
-----
- Unable to install node on OSX
	- http://forums.webhook.com/t/cant-get-node-to-install-on-latest-osx-mavericks-resolved/109/12


Sample Team Project Structure Guideline
====================
Each project team should contain below folder structure:

###Sample team project: mobile web team
`README.md` -- Information for your team project
`package.json` -- define dependencies for your team project. Refer to `Example of package.json` 
 `/po` -- page object - page declarations goes here
	+ `loginpage.po.js`
	+ `signuppage.po.js`
	+ `myjobspage.po.js`
	+ `workdiarypage.po.js`
`/specs` -- test files. All tests should be saved under this folder. Priority will be defined in Jenkins so no need to define here. 
	+ `EOM-110_spec.js`
	+ `EOM-116_spec.js`
	+ `EOM-204_spec.js` 


Protractor-core Structure
====================
+ /commons -- contains generic utility functions that can be used for all project teams.   
+ /conf -- contains team specific configuration set up. 
+ /docs -- contains ngdoc files 
+ /node_modules -- dependency libraries that is defined in package.json
+ .gitignore -- used by git that contains the file names or folders to be ignored for tracking
+ grunt -- utility file to check and compile ngdoc
+ package.json -- to define the dependency libraries that support protractor-core
+ README.md -- this file
+ README-Agora.md -- brief intro of agora.js 
+ README-ngdoc.md -- explain how to generate ngdoc
+ README-orpc.md -- brief intro of orpc.js
+ README-PO.md -- brief intro of the page object design 



###Documentation using NGdoc
+ https://github.com/angular/angular.js/wiki/Writing-AngularJS-Documentation
+ You'll need a grunt file to run this. Ex: Mobile is based on Page Object structure/orientation.  As such, all our function/methods are require to have ngdoc style documentation.
+ Sample: http://jenkinsqa.odesk.com:8002/docs/#/e2e/header  :: It is searchable and easily readable. 
+ We also have page object -> UI mapping: http://stash.odesk.com/projects/QA/repos/mobile2.0/browse/poMapping

###Sample Script:
+ Refer to our mobile2.0 ReadMe: http://stash.odesk.com/projects/QA/repos/mobile2.0/browse

![Alt text](jenkinsCI.png?raw=true "Jenkins CI")




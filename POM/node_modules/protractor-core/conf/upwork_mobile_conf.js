/**
 * @name upwork_conf.js
 * @description Standard conf to be use for automation on upwork web pages.
 *
 */

//var HtmlReporter = require('protractor-html-screenshot-reporter');
var jasmine2ScreenshotReporter = require('protractor-jasmine2-screenshot-reporter');

var baseConf = require('./base_conf.js');
var baseConfig = new baseConf();

exports.config = {

  seleniumAddress: 'http://localhost:4444/wd/hub',

  params: {
    testenv: 'stage',
    report: 'result',
    globalTimeout: baseConfig.timeout.pageLoad,
    waitForAngular: {
      angularFlag: true,  //Only use false if timeout/interval for polling is failing.
      angularDelay: baseConfig.timeout.angularDelay //this only goes into affect if angularFlag=false
    }
  },

  capabilities: {
    'browserName': 'chrome',
    'chromeOptions': {
      'args': [
        '--window-size=1024,768',
        '--test-type',
        '--use-mobile-user-agent',
        "--user-agent='Mozilla/5.0 (iPhone; CPU iPhone OS 7_0 like Mac OS X; en-us) AppleWebKit/537.51.1 (KHTML, like Gecko) Version/7.0 Mobile/11A465 Safari/9537.53'"
      ]
    }
  },

  specs: [
    '../specs/WP-lam_spec.js'
  ],


  allScriptsTimeout: baseConfig.timeout.allScriptsTimeout,

  // Framework to use. Jasmine 2 is recommended.
  framework: 'jasmine2',

  onPrepare: function () {
    browser.manage().timeouts().pageLoadTimeout(baseConfig.timeout.pageLoad);
    browser.manage().timeouts().implicitlyWait(baseConfig.timeout.implicitWait);
    browser.driver.manage().window().setSize(400,800);


    // jasmine2 screenshot reporter
    jasmine.getEnv().addReporter(
      new jasmine2ScreenshotReporter({
        dest: browser.params.report,
        filename: 'report.html',
        reportOnlyFailedSpecs: false,
        captureOnlyFailedSpecs: true
      }));

    var jasmineReporters = require('jasmine-reporters');

    jasmine.getEnv().addReporter(
      new jasmineReporters.JUnitXmlReporter({
        savePath: browser.params.report,
        consolidateAll: false
      }));

    jasmine.getEnv().addReporter(
      new jasmineReporters.NUnitXmlReporter({
        savePath: browser.params.report
      }));

    jasmine.getEnv().addReporter(
      new jasmineReporters.TapReporter());

    jasmine.getEnv().addReporter(
      new jasmineReporters.TerminalReporter({
        verbosity: 3,
        color: true,
        showStack: true
      }));


  },

// Options to be passed to Jasmine-node.
  jasmineNodeOpts: {
    showColors: true,
    defaultTimeoutInterval: baseConfig.timeout.defaultTimeoutInterval
  }

}
;
